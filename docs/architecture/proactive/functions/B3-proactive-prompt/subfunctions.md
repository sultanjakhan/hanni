# B3 — Построение системного промпта: Подфункции

> Декомпозиция бизнес-функции на атомарные шаги.
> Phase 3 drill-down.

## Обзор

| Метрика | Значение |
|---------|----------|
| Бизнес-функция | B3: Построение системного промпта |
| Файл(ы) | lib.rs:L6385-6436 |
| LOC | 52 |
| Подфункций | 4 |
| Сложность (max) | Low |

## Подфункции

| # | Подфункция | Строки | LOC | Input → Output | Side effects | Тип | Сложность |
|---|-----------|--------|-----|---------------|-------------|-----|-----------|
| B3.1 | Определение ProactiveStyleDef + ALL_PROACTIVE_STYLES | L6385-6405 | 21 | — → const массив из 14 стилей | — | transform | Low |
| B3.2 | Фильтрация стилей по enabled_styles | L6407-6421 | 15 | enabled_styles[] → prompt string | — | transform | Low |
| B3.3 | Обёртка gather_context (async + timeout) | L6424-6434 | 11 | — → context string | spawn_blocking + timeout 30s | control | Low |
| B3.4 | (Строка-разделитель перед helpers) | L6436 | 1 | — | — | — | Trivial |

## Проблемные зоны

Нет критичных проблем.
